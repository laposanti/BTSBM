<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Notation and Object Dimensions for the Bradley–Terry Stochastic Block Model • BTSBM: Bradley–Terry Stochastic Block Model</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Inter-0.4.10/font.css" rel="stylesheet">
<link href="../deps/JetBrains_Mono-0.4.10/font.css" rel="stylesheet">
<link href="../deps/Inter_Tight-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Notation and Object Dimensions for the Bradley–Terry Stochastic Block Model">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">BTSBM: Bradley–Terry Stochastic Block Model</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/getting-started.html">Getting started with BTSBM: the R package for the BT-SBM paper</a></li>
    <li><a class="dropdown-item" href="../articles/Notation.html">Notation and Object Dimensions for the Bradley–Terry Stochastic Block Model</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/laposanti/BTSBM/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Notation and Object Dimensions for the Bradley–Terry Stochastic Block Model</h1>
            
            <h4 data-toc-skip class="date">2025-10-23</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/laposanti/BTSBM/blob/main/vignettes/Notation.Rmd" class="external-link"><code>vignettes/Notation.Rmd</code></a></small>
      <div class="d-none name"><code>Notation.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>We consider a set of (n) items/players with observed directed wins
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">w_{ij}</annotation></semantics></math>).
The total number of encounters is
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><msub><mi>w</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>+</mo><msub><mi>w</mi><mrow><mi>j</mi><mi>i</mi></mrow></msub></mrow><annotation encoding="application/x-tex">n_{ij} = w_{ij} + w_{ji}</annotation></semantics></math>).
In the clustered Bradley–Terry–SBM (BT–SBM), each item (i) belongs to a
latent block
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub><mo>∈</mo><mrow><mn>1</mn><mo>,</mo><mi>…</mi><mo>,</mo><mi>K</mi></mrow></mrow><annotation encoding="application/x-tex">x_i \in {1,\dots,K}</annotation></semantics></math>),
and blocks have intensities
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>λ</mi><mi>k</mi></msub><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\lambda_k&gt;0</annotation></semantics></math>).
The simple BT model corresponds to
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mo>=</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">K=n</annotation></semantics></math>)
with item-specific intensities.</p>
<p>This vignette documents <strong>symbols</strong>, <strong>R object
names</strong>, and <strong>dimensions</strong> used throughout the
package.</p>
</div>
<div class="section level2">
<h2 id="symbols-and-r-names">Symbols and R names<a class="anchor" aria-label="anchor" href="#symbols-and-r-names"></a>
</h2>
<table class="table">
<colgroup>
<col width="19%">
<col width="19%">
<col width="27%">
<col width="14%">
<col width="18%">
</colgroup>
<thead><tr class="header">
<th>Meaning</th>
<th>Math symbol</th>
<th>Constraints / Type</th>
<th>R name</th>
<th>Dimensions</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Number of items</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math></td>
<td>integer (&gt;0)</td>
<td>
<code>n</code> (derived)</td>
<td>scalar</td>
</tr>
<tr class="even">
<td>Saved iterations</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>=</mo><msub><mi>T</mi><mtext mathvariant="normal">iter</mtext></msub><mo>−</mo><msub><mi>T</mi><mtext mathvariant="normal">burn</mtext></msub></mrow><annotation encoding="application/x-tex">S = T_{\text{iter}} - T_{\text{burn}}</annotation></semantics></math></td>
<td>integer (≥ 1)</td>
<td>
<code>S</code> (implicit)</td>
<td>scalar</td>
</tr>
<tr class="odd">
<td>Wins (i over j)</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">w_{ij}</annotation></semantics></math></td>
<td>≥ 0, diag = 0</td>
<td><code>w_ij</code></td>
<td>
<code>n × n</code> matrix</td>
</tr>
<tr class="even">
<td>Encounters</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><msub><mi>w</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>+</mo><msub><mi>w</mi><mrow><mi>j</mi><mi>i</mi></mrow></msub></mrow><annotation encoding="application/x-tex">n_{ij} = w_{ij} + w_{ji}</annotation></semantics></math></td>
<td>symmetric, diag = 0</td>
<td>computed internally</td>
<td>
<code>n × n</code> matrix</td>
</tr>
<tr class="odd">
<td>Total iterations</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>T</mi><mtext mathvariant="normal">iter</mtext></msub><annotation encoding="application/x-tex">T_{\text{iter}}</annotation></semantics></math></td>
<td>integer (&gt;0)</td>
<td><code>T_iter</code></td>
<td>scalar</td>
</tr>
<tr class="even">
<td>Burn-in</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>T</mi><mtext mathvariant="normal">burn</mtext></msub><annotation encoding="application/x-tex">T_{\text{burn}}</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>≤</mo><msub><mi>T</mi><mtext mathvariant="normal">burn</mtext></msub><mo>&lt;</mo><msub><mi>T</mi><mtext mathvariant="normal">iter</mtext></msub></mrow><annotation encoding="application/x-tex">0 \le T_{\text{burn}} &lt; T_{\text{iter}}</annotation></semantics></math></td>
<td><code>T_burn</code></td>
<td>scalar</td>
</tr>
<tr class="odd">
<td>Occupied clusters per draw</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math></td>
<td>1..n</td>
<td><code>K_per_iter</code></td>
<td>length <code>S</code> vector</td>
</tr>
<tr class="even">
<td>Label capacity (allocated ids)</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>L</mi><mtext mathvariant="normal">cap</mtext></msub><annotation encoding="application/x-tex">L_{\text{cap}}</annotation></semantics></math></td>
<td>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mo>≤</mo><msub><mi>L</mi><mtext mathvariant="normal">cap</mtext></msub><mo>≤</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">K \le L_{\text{cap}} \le n</annotation></semantics></math>
(or ≤
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>K</mi><mrow><mi>D</mi><mi>M</mi></mrow></msub><annotation encoding="application/x-tex">K_{DM}</annotation></semantics></math>)</td>
<td><code>L_cap_per_iter</code></td>
<td>length <code>S</code> vector</td>
</tr>
<tr class="odd">
<td>Max allowed clusters (finite prior)</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>K</mi><mrow><mi>D</mi><mi>M</mi></mrow></msub><annotation encoding="application/x-tex">K_{DM}</annotation></semantics></math></td>
<td>1..n or ∞</td>
<td><code>K_DM</code></td>
<td>scalar</td>
</tr>
<tr class="even">
<td>Observed pairs count</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>D</mi><annotation encoding="application/x-tex">D</annotation></semantics></math></td>
<td>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mo>=</mo><mi>#</mi><mo stretchy="false" form="prefix">{</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>:</mo><mi>i</mi><mo>&lt;</mo><mi>j</mi><mo>,</mo><mspace width="0.222em"></mspace><msub><mi>n</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>&gt;</mo><mn>0</mn><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">D = \#\{(i,j): i&lt;j,\ n_{ij}&gt;0\}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>≤</mo><mi>D</mi><mo>≤</mo><mfrac displaystyle="false"><mrow><mi>n</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mn>2</mn></mfrac></mrow><annotation encoding="application/x-tex">0 \le D \le \tfrac{n(n-1)}{2}</annotation></semantics></math>
</td>
<td>implicit</td>
<td>scalar</td>
</tr>
<tr class="odd">
<td>Cluster label of item i</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mi>i</mi></msub><annotation encoding="application/x-tex">x_i</annotation></semantics></math></td>
<td>in {1..K}</td>
<td><code>x_samples</code></td>
<td>
<code>S × n</code> integer matrix</td>
</tr>
<tr class="even">
<td>Cluster intensities</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>λ</mi><mi>k</mi></msub><annotation encoding="application/x-tex">\lambda_k</annotation></semantics></math></td>
<td>&gt; 0</td>
<td><code>lambda_list[[s]]</code></td>
<td>ragged numeric, length <code>L_cap[s]</code>
</td>
</tr>
<tr class="odd">
<td>Item intensity (post relabel)</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>λ</mi><msub><mi>x</mi><mi>i</mi></msub></msub><annotation encoding="application/x-tex">\lambda_{x_i}</annotation></semantics></math></td>
<td>&gt; 0</td>
<td><code>lambda_samples_relabel</code></td>
<td>
<code>S × n</code> numeric matrix</td>
</tr>
<tr class="even">
<td>Latent auxiliaries</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Z</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">Z_{ij}</annotation></semantics></math></td>
<td>≥ 0</td>
<td><code>z_samples</code></td>
<td>
<code>S × n × n</code> array or <code>NULL</code>
</td>
</tr>
<tr class="odd">
<td>DP concentration</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></td>
<td>&gt; 0</td>
<td><code>alpha_PY</code></td>
<td>scalar</td>
</tr>
<tr class="even">
<td>PY discount</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>σ</mi><annotation encoding="application/x-tex">\sigma</annotation></semantics></math></td>
<td>[0,1)</td>
<td><code>sigma_PY</code></td>
<td>scalar</td>
</tr>
<tr class="odd">
<td>DM concentration</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math></td>
<td>&gt; 0</td>
<td><code>beta_DM</code></td>
<td>scalar</td>
</tr>
<tr class="even">
<td>GN parameter</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>γ</mi><annotation encoding="application/x-tex">\gamma</annotation></semantics></math></td>
<td>&gt; 0</td>
<td><code>gamma_GN</code></td>
<td>scalar</td>
</tr>
<tr class="odd">
<td>Gamma prior on λ</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi><mo>∼</mo><mrow><mi mathvariant="normal">G</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\lambda \sim \mathrm{Gamma}(a,b)</annotation></semantics></math></td>
<td>a&gt;0, b&gt;0</td>
<td>
<code>a</code>, <code>b_eff = exp(ψ(a))</code>
</td>
<td>scalars</td>
</tr>
</tbody>
</table>
<p>Notes:</p>
<ul>
<li>We <strong>never</strong> require the user to pass
<code>n_ij</code>; it is constructed and validated internally.</li>
<li>After relabeling by decreasing
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>),
cluster ids are canonicalized as
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mi>.</mi><mi>.</mi><mi>.</mi><mi>K</mi></mrow><annotation encoding="application/x-tex">1...K</annotation></semantics></math>)
with cluster 1 the largest
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>).</li>
</ul>
</div>
<div class="section level2">
<h2 id="dimensions-at-a-glance">Dimensions at a glance<a class="anchor" aria-label="anchor" href="#dimensions-at-a-glance"></a>
</h2>
<p>Let
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>=</mo><msub><mi>T</mi><mtext mathvariant="normal">iter</mtext></msub><mo>−</mo><msub><mi>T</mi><mtext mathvariant="normal">burn</mtext></msub></mrow><annotation encoding="application/x-tex">S = T_{\text{iter}} - T_{\text{burn}}</annotation></semantics></math>).</p>
<ul>
<li>
<code>w_ij</code>: <code>n x n</code>
</li>
<li>internally computed <code>n_ij</code>: <code>n x n</code>
</li>
<li>
<code>x_samples</code>: <code>S x n</code>
</li>
<li>
<code>lambda_list</code>: length <code>S</code>, element
<code>s</code> has length <code>L_cap[s]</code>, with <code>NA</code> at
empty labels</li>
<li>
<code>lambda_samples_relabel</code>: <code>S x n</code>
</li>
<li>
<code>z_samples</code> (if stored): <code>S x n x n</code>
</li>
<li>
<code>K_per_iter</code>, <code>L_cap_per_iter</code>: length
<code>S</code>
</li>
<li>LOO log-likelihood matrices: <code>ll</code> is <code>S x D</code>,
where <code>D = # {(i,j): i&lt;j, n_ij[i,j]&gt;0}</code> and
<code>obs_idx</code> is <code>D x 2</code>
</li>
</ul>
<div class="section level3">
<h3 id="gibbs-samplers">Gibbs samplers<a class="anchor" aria-label="anchor" href="#gibbs-samplers"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Clustered BT–SBM</span></span>
<span><span class="fu"><a href="../reference/gibbs_bt_sbm.html">gibbs_bt_sbm</a></span><span class="op">(</span></span>
<span>  <span class="va">w_ij</span>,</span>
<span>  prior   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"DP"</span>,<span class="st">"PY"</span>,<span class="st">"DM"</span>,<span class="st">"GN"</span><span class="op">)</span>,</span>
<span>  a       <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  alpha_PY <span class="op">=</span> <span class="cn">NA_real_</span>,</span>
<span>  sigma_PY <span class="op">=</span> <span class="cn">NA_real_</span>,</span>
<span>  beta_DM  <span class="op">=</span> <span class="cn">NA_real_</span>,</span>
<span>  K_DM    <span class="op">=</span> <span class="cn">NA_integer_</span>,</span>
<span>  gamma_GN <span class="op">=</span> <span class="cn">NA_real_</span>,</span>
<span>  T_iter <span class="op">=</span> <span class="fl">2000</span>,</span>
<span>  T_burn <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  init_x <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  store_z <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><strong>Returns</strong> (sizes in terms of <code>n</code> and
<code>S</code>):</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">list</span>(</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>  <span class="at">x_samples            =</span> integer matrix [S x n],</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>  <span class="at">lambda_samples       =</span> list length S; each numeric vector length L_cap[s], <span class="cn">NA</span> <span class="cf">for</span> empty labels,</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>  <span class="at">K_per_iter           =</span> integer vector [S],</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>  <span class="at">L_cap_per_iter       =</span> integer vector [S],</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>  <span class="at">z_samples            =</span> <span class="cn">NULL</span> or numeric array [S x n x n]</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simple BT (no clustering)</span></span>
<span><span class="fu"><a href="../reference/gibbs_bt_simple.html">gibbs_bt_simple</a></span><span class="op">(</span></span>
<span>  <span class="va">w_ij</span>,</span>
<span>  a <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  b <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  T_iter <span class="op">=</span> <span class="fl">5000</span>,</span>
<span>  T_burn <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><strong>Returns</strong>:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">list</span>(<span class="at">lambda_samples =</span> numeric matrix [S x n])</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="relabeling-and-summaries">Relabeling and summaries<a class="anchor" aria-label="anchor" href="#relabeling-and-summaries"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/relabel_by_lambda.html">relabel_by_lambda</a></span><span class="op">(</span><span class="va">x_samples</span>, <span class="va">lambda_samples</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>
<code>x_samples</code>: integer matrix <code>[S x n]</code> (raw ids
per draw)</li>
<li>
<code>lambda_samples</code>: either a list length <code>S</code> of
per-label vectors (ragged, <code>NA</code> for empties), or a matrix
<code>[S x L_cap_max]</code> with <code>NA</code>s.</li>
</ul>
<p><strong>Returns</strong>:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">list</span>(</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>  <span class="at">x_samples_relabel              =</span> integer matrix [S x n],</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>  <span class="at">lambda_samples_relabel         =</span> numeric matrix  [S x n],</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>  <span class="at">item_cluster_assignment_probs  =</span> data.frame [n x K_max] (columns named <span class="st">"Cluster_k"</span>),</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>  <span class="at">block_count_distribution       =</span> data.frame with columns {num_blocks, count, prob},</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>  <span class="at">avg_top_block_count            =</span> <span class="fu">numeric</span>(<span class="dv">1</span>),</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>  <span class="at">co_clustering                  =</span> numeric matrix [n x n],</span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>  <span class="at">minVI_partition                =</span> integer vector length n,</span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a>  <span class="at">partition_binder               =</span> integer vector length n,</span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a>  <span class="at">n_clusters_each_iter           =</span> integer vector length S,</span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a>  <span class="at">top_block_count_per_iter       =</span> integer vector length S,</span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a>  <span class="at">cluster_lambda_ordered         =</span> list length S; numeric vectors length K[s]</span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="loo-log-likelihood-builders">LOO log-likelihood builders<a class="anchor" aria-label="anchor" href="#loo-log-likelihood-builders"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/make_bt_simple_loo.html">make_bt_simple_loo</a></span><span class="op">(</span><span class="va">w_ij</span>, <span class="va">lambda_samples</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/make_bt_cluster_loo.html">make_bt_cluster_loo</a></span><span class="op">(</span><span class="va">w_ij</span>, <span class="va">lambda_samples</span>, <span class="va">x_samples</span><span class="op">)</span></span></code></pre></div>
<p><strong>Both return</strong>:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">list</span>(</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>  <span class="at">ll =</span> numeric matrix [S x D],</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>  <span class="at">obs_idx =</span> integer matrix [D x <span class="dv">2</span>]  <span class="co"># i,j pairs with n_ij[i,j] &gt; 0</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="model-comparison">Model comparison<a class="anchor" aria-label="anchor" href="#model-comparison"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/compare_bt_models_loo.html">compare_bt_models_loo</a></span><span class="op">(</span><span class="va">simple_llo</span>, <span class="va">cluster_llo</span><span class="op">)</span></span></code></pre></div>
<p><strong>Returns</strong> a list with <code>simple</code>,
<code>cluster</code> (both <code>loo</code> objects) and
<code>comparison</code> (from <code>loo::compare_models</code>).</p>
</div>
<div class="section level3">
<h3 id="plotting-helpers-selected">Plotting helpers (selected)<a class="anchor" aria-label="anchor" href="#plotting-helpers-selected"></a>
</h3>
<ul>
<li>
<code>plot_block_adjacency(fit, w_ij, ...)</code> – square heatmap
ordered by block and marginal wins.</li>
<li>
<code>plot_assignment_probabilities(fit, w_ij = NULL, ...)</code> –
item-by-cluster assignment heatmap.</li>
<li>
<code>plot_lambda_uncertainty(fit, w_ij, ...)</code> – forest plot
of per-item () intervals (on log scale).</li>
</ul>
<p>These accept <code>w_ij</code> to recover names and marginal
summaries. They do <strong>not</strong> require <code>n_ij</code>.</p>
</div>
</div>
<div class="section level2">
<h2 id="internal-bookkeeping-l_cap-vs-k">Internal bookkeeping: <code>L_cap</code> vs <code>K</code><a class="anchor" aria-label="anchor" href="#internal-bookkeeping-l_cap-vs-k"></a>
</h2>
<p>We distinguish:</p>
<ul>
<li>
<code>K</code> – number of occupied clusters in a draw (size of
<code>{k: csize[k] &gt; 0}</code>).</li>
<li>
<code>L_cap</code> – <strong>label capacity</strong>, the current
size of the allocated label id space. It satisfies
<code>K ≤ L_cap ≤ min(n, K_max)</code> and is used to size arrays such
as <code>lambda_curr</code>. Empty labels have <code>NA</code>
intensity.</li>
</ul>
<p>Diagnostics stored per saved draw: <code>K_per_iter</code> and
<code>L_cap_per_iter</code>.</p>
</div>
<div class="section level2">
<h2 id="validation-rules">Validation rules<a class="anchor" aria-label="anchor" href="#validation-rules"></a>
</h2>
<ul>
<li>
<code>w_ij</code> must be a square non-negative integer/numeric
matrix with zero diagonal.</li>
<li>Internally computed <code>n_ij = w_ij + t(w_ij)</code> is symmetric
with zero diagonal; we error if not.</li>
<li>For finite-cap priors, we enforce <code>K ≤ K_max</code> in both the
urn weight and capacity growth.</li>
</ul>
</div>
<div class="section level2">
<h2 id="minimal-end-to-end-example">Minimal end-to-end example<a class="anchor" aria-label="anchor" href="#minimal-end-to-end-example"></a>
</h2>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">6L</span></span>
<span><span class="va">w</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0L</span>, <span class="va">n</span>, <span class="va">n</span><span class="op">)</span></span>
<span><span class="va">w</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html" class="external-link">lower.tri</a></span><span class="op">(</span><span class="va">w</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html" class="external-link">lower.tri</a></span><span class="op">(</span><span class="va">w</span><span class="op">)</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">w</span> <span class="op">&lt;-</span> <span class="va">w</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">w</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">w</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">w</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>  <span class="co"># keep diag 0, symmetric wins implied through n_ij</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">w</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">w</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"P"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gibbs_bt_sbm.html">gibbs_bt_sbm</a></span><span class="op">(</span></span>
<span>  w_ij <span class="op">=</span> <span class="va">w</span>,</span>
<span>  prior <span class="op">=</span> <span class="st">"GN"</span>,</span>
<span>  gamma_GN <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  T_iter <span class="op">=</span> <span class="fl">300</span>,</span>
<span>  T_burn <span class="op">=</span> <span class="fl">150</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">rel</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/relabel_by_lambda.html">relabel_by_lambda</a></span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">x_samples</span>, <span class="va">fit</span><span class="op">$</span><span class="va">lambda_samples</span><span class="op">)</span></span>
<span><span class="va">loo_simple</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_bt_simple_loo.html">make_bt_simple_loo</a></span><span class="op">(</span><span class="va">w</span>, lambda_samples <span class="op">=</span> <span class="fu"><a href="../reference/gibbs_bt_simple.html">gibbs_bt_simple</a></span><span class="op">(</span><span class="va">w</span>, T_iter<span class="op">=</span><span class="fl">200</span>, T_burn<span class="op">=</span><span class="fl">100</span>, verbose<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">$</span><span class="va">lambda_samples</span><span class="op">)</span></span>
<span><span class="va">loo_cluster</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_bt_cluster_loo.html">make_bt_cluster_loo</a></span><span class="op">(</span><span class="va">w</span>, <span class="va">rel</span><span class="op">$</span><span class="va">cluster_lambda_ordered</span>, <span class="va">rel</span><span class="op">$</span><span class="va">x_samples_relabel</span><span class="op">)</span></span>
<span><span class="va">comp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compare_bt_models_loo.html">compare_bt_models_loo</a></span><span class="op">(</span><span class="va">loo_simple</span>, <span class="va">loo_cluster</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="package-documentation-style">Package documentation style<a class="anchor" aria-label="anchor" href="#package-documentation-style"></a>
</h2>
<ul>
<li>Arguments use <strong>snake_case</strong>.</li>
<li>Matrices with indexed entries use the <code>_ij</code> suffix.</li>
<li>Iteration counts are <code>T_iter</code> and
<code>T_burn</code>.</li>
<li>Finite-cap prior parameter is <code>K_max</code>.</li>
<li>Roxygen: use <code>@param w_ij</code> (wins), state that
<code>n_ij</code> is computed internally.</li>
<li>Equations in roxygen use <code>\eqn{}</code> and
<code>\deqn{}</code>; in articles use inline <code>\( \)</code> and
display <code>\[ \]</code>.</li>
</ul>
</div>
<div class="section level2">
<h2 id="linking-this-vignette-in-pkgdown">Linking this vignette in pkgdown<a class="anchor" aria-label="anchor" href="#linking-this-vignette-in-pkgdown"></a>
</h2>
<p>Add to <code>_pkgdown.yml</code>:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="fu">articles</span><span class="kw">:</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">title</span><span class="kw">:</span><span class="at"> Concepts</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="at">    </span><span class="fu">contents</span><span class="kw">:</span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> notation</span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="fu">navbar</span><span class="kw">:</span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a><span class="at">  </span><span class="fu">structure</span><span class="kw">:</span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a><span class="at">    </span><span class="fu">left</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">reference</span><span class="kw">,</span><span class="at"> articles</span><span class="kw">]</span></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a><span class="at">  </span><span class="fu">components</span><span class="kw">:</span></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a><span class="at">    </span><span class="fu">articles</span><span class="kw">:</span></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a><span class="at">      </span><span class="fu">text</span><span class="kw">:</span><span class="at"> Articles</span></span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a><span class="at">      </span><span class="fu">menu</span><span class="kw">:</span></span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">text</span><span class="kw">:</span><span class="at"> </span><span class="st">"Notation &amp; Conventions"</span></span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a><span class="at">          </span><span class="fu">href</span><span class="kw">:</span><span class="at"> articles/notation.html</span></span></code></pre></div>
<p>Ensure the vignette file is saved as
<code>vignettes/notation.Rmd</code> and that <code>DESCRIPTION</code>
contains:</p>
<pre class="text"><code>Suggests: knitr, rmarkdown, pkgdown
VignetteBuilder: knitr</code></pre>
</div>
<div class="section level2">
<h2 id="appendix-probability-parameterizations">Appendix: Probability parameterizations<a class="anchor" aria-label="anchor" href="#appendix-probability-parameterizations"></a>
</h2>
<ul>
<li><p><strong>Bradley–Terry mapping</strong>: given item-level rates
(), define [_{ij} = ] The helper <code>lambda_to_theta(lambda)</code>
returns the full (nn) matrix with (_{ii}=1/2).</p></li>
<li><p><strong>Gamma prior centering</strong>: we use rate parameter (b_
= ((a))) so that ([] = 0) a priori, aiding identifiability via global
rescaling.</p></li>
<li><p><strong>Relabeling convention</strong>: in each saved draw we
order occupied clusters by decreasing () and remap labels to (1..K).
Item-level intensities after relabeling are stored as
<code>lambda_samples_relabel</code> with shape
<code>S x n</code>.</p></li>
</ul>
<hr>
<p><strong>Version note.</strong> If you previously used
<code>n_iter</code>, <code>burnin</code>, or <code>H_DM</code> in
earlier versions, these are now <code>T_iter</code>,
<code>T_burn</code>, and <code>K_max</code>. Backward-compatibility
shims may emit deprecation warnings.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Lapo Santi.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
