% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gibbs_bt_sbm.R
\name{gibbs_bt_sbm}
\alias{gibbs_bt_sbm}
\title{Gibbs sampler for a Bradley–Terry Stochastic Block Model (BT–SBM)}
\usage{
gibbs_bt_sbm(
  w_ij,
  a = 4,
  prior = c("DP", "PY", "DM", "GN"),
  alpha_PY = NA_real_,
  sigma_PY = NA_real_,
  beta_DM = NA_real_,
  H_DM = NA_integer_,
  gamma_GN = NA_real_,
  n_iter = 2000,
  burnin = 1000,
  init_x = NULL,
  store_z = FALSE,
  verbose = TRUE
)
}
\arguments{
\item{w_ij}{Integer or numeric square matrix \eqn{n \times n} of directed wins
(e.g., \code{w_ij[i,j]} is wins of \eqn{i} over \eqn{j}). Must have nonnegative
entries and \code{n_ij <= w_ij + t(w_ij)} elementwise.}

\item{a}{positive parameter for the Gamma prior \eqn{\lambda_k \sim \mathrm{Gamma}(a,b)}.
The algorithm uses \eqn{b=\exp(\psi(a))} to align the prior with the likelihood expectation on log \eqn{\lambda_k}}

\item{prior}{Character scalar, one of \code{"DP"}, \code{"PY"}, \code{"DM"}, \code{"GN"}.}

\item{alpha_PY, sigma_PY}{Hyperparameters for Pitman–Yor/Dirichlet Process.
For \code{prior="DP"} use \code{alpha_PY}; for \code{prior="PY"} use both
\code{alpha_PY} and \code{sigma_PY in (0,1)}.}

\item{beta_DM, H_DM}{Hyperparameters for the Dirichlet–Multinomial prior
where \code{H_DM} gives the maximum number of allowed clusters.}

\item{gamma_GN}{Hyperparameter for the Gnedin prior.}

\item{n_iter, burnin}{Integers, total iterations and burn-in. Must satisfy \code{burnin < n_iter}.}

\item{init_x}{Optional integer vector of length \code{n} with initial labels (1-based).}

\item{store_z}{Logical, store latent \code{Z} draws (heavy; defaults \code{FALSE}).}

\item{verbose}{Logical, progress every 1000 iterations.}
}
\value{
A plain \code{list} with the following elements:
list with \code{x} (matrix \code{S x n} of raw labels),
\code{K} (vector length \code{S})
}
\description{
Runs the Gibbs sampler for the BT–SBM.
It then returns relabeled samples and computes minimal posterior summaries.
Row names of \code{w_ij} (if present) are propagated to all item-level outputs;
otherwise items are named \code{Item_1, ..., Item_N}.
}
\examples{
\dontrun{
set.seed(1)
n <- 6L
w <- matrix(0L, n, n)
w[lower.tri(w)] <- rpois(sum(lower.tri(w)), 2)
rownames(w) <- colnames(w) <- paste0("P", seq_len(n))
fit <- gibbs_bt_sbm(w, prior="GN", gamma_GN=0.5, n_iter=200, burnin=100)
}
}
