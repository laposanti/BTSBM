% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/E_VAR_K.R
\name{gnedin_K_var}
\alias{gnedin_K_var}
\title{Variance of the number of clusters under the Gnedin prior}
\usage{
gnedin_K_var(n, gamma)
}
\arguments{
\item{n}{Integer vector of sample sizes (each \eqn{\ge 1}).}

\item{gamma}{Numeric vector of Gnedin parameters, each in \eqn{(0,1)}.}
}
\value{
A numeric vector with \eqn{\mathrm{Var}(K_n)} for each pair \code{(n, gamma)}.
}
\description{
Compute the closed-form variance of \eqn{K_n} under the Gnedin finite-type model
(\eqn{\sigma=-1}).
}
\details{
Using the factorial–ordinary moment relation
\eqn{\mathbb{E}[K_n^2]=\mathbb{E}[K_n(K_n-1)]+\mathbb{E}[K_n]}, the variance is
\deqn{
  \mathrm{Var}(K_n) \;=\; \mathbb{E}[K_n(K_n-1)] + \mathbb{E}[K_n] - \{\mathbb{E}[K_n]\}^2,
}
where
\deqn{
  \mathbb{E}[K_n(K_n-1)]
  \;=\; n(n-1)(1-\gamma)\,\frac{\Gamma(n)\,\Gamma(1+\gamma)}{\Gamma(n+\gamma)}.
}
The implementation uses \code{lgamma} for numerical stability and is vectorized
over \code{n} and \code{gamma} (with standard R recycling rules).
}
\examples{
# Scalar inputs
gnedin_K_var(105, 0.8)

# Consistency check: variance is nonnegative
all(gnedin_K_var(20, c(0.3, 0.5, 0.8)) >= 0)

}
\references{
Gnedin, A. (2010). A species sampling model with finitely many types.
\emph{Electronic Communications in Probability}, 15, 79–88.

Favaro, S., Lijoi, A., & Prünster, I. (2013).
Extending the class of Gibbs-type priors: theoretical properties and new examples.
\emph{Annals of Applied Probability}, 23(4), 1729–1754.

Pitman, J. (2006). \emph{Combinatorial Stochastic Processes}. Springer.
}
\seealso{
\code{\link[=gnedin_K_mean]{gnedin_K_mean()}}
}
