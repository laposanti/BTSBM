% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/sample_from_BTSBM.R
\name{sample_from_BTSBM}
\alias{sample_from_BTSBM}
\title{Sample a Bradley–Terry Stochastic Block Model (BT-SBM) tournament}
\usage{
sample_from_BTSBM(
  n_players,
  K,
  x = NULL,
  mean_matches = 5,
  p_edge = 0.5,
  lambda = NULL,
  lambda_base = 0.08,
  lambda_ratio = 2.3,
  reverse_lambda = TRUE,
  seed = NULL
)
}
\arguments{
\item{n_players}{Integer. Number of players \eqn{n}.}

\item{K}{Integer. Number of blocks.}

\item{x}{Optional integer vector of length \code{n_players} with values in
\code{1:K}. If \code{NULL}, uses \code{rep(seq_len(K), length.out = n_players)}.}

\item{mean_matches}{Positive numeric. Poisson mean for match counts on
present edges.}

\item{p_edge}{Numeric in [0,1]. Probability that an unordered pair is
present in the topology.}

\item{lambda}{Optional positive numeric vector of length \code{K}. If \code{NULL},
a geometric sequence is used: \code{lambda_base * lambda_ratio^(0:(K-1))}.}

\item{lambda_base}{Positive numeric. Base of the geometric schedule when
\code{lambda} is not provided. Default \code{0.08} (as in your snippet).}

\item{lambda_ratio}{Positive numeric. Ratio of the geometric schedule when
\code{lambda} is not provided. Default \code{2.3} (as in your snippet).}

\item{reverse_lambda}{Logical. If \code{TRUE}, uses \code{rev(lambda)} when computing
\code{theta}, matching your \code{theta_star <- lambda_to_theta(rev(lambda_star))}.}

\item{seed}{Optional integer. If provided, sets the RNG seed for
reproducibility \emph{within the function call}.}
}
\value{
A list with components:
\itemize{
\item \code{N} — \eqn{n \times n} integer matrix of symmetric match counts with
zero diagonal.
\item \code{W} — \eqn{n \times n} integer matrix of directed win counts with
\code{w[i, j] + w[j, i] = N[i, j]}.
\item \code{x} — integer vector of block labels in \code{1:K}.
\item \code{lambda} — numeric vector of length \code{K} used to build \code{theta}.
\item \code{theta} — \eqn{K \times K} matrix with entries
\eqn{\theta_{ab} = \lambda_a / (\lambda_a + \lambda_b)}.
}
}
\description{
Generates a sparse undirected match matrix \eqn{N} and corresponding
directed win counts matrix \eqn{W} under the BTSBM
generating process. Block strengths are specified via a positive vector
\eqn{\lambda}, mapped to pairwise win probabilities
\eqn{\theta_{ab} = \lambda_a / (\lambda_a + \lambda_b)}.
}
\details{
The workflow is:
\enumerate{
\item Sample a symmetric match-count matrix \eqn{N} by first drawing a random
subset of unordered pairs with probability \code{p_edge}, then assigning each
selected pair a Poisson\eqn{(mean\_matches)} number of matches.
\item Compute the block-to-block Bradley–Terry matrix
\eqn{\theta = \lambda \mathbf{1}^\top / (\lambda \mathbf{1}^\top + \mathbf{1}\lambda^\top)}.
\item For each unordered pair with \eqn{N_{ij}>0}, draw
\eqn{w_{ij} \sim \text{Binomial}(N_{ij}, \theta_{x_i, x_j})} and set
\eqn{w_{ji} = N_{ij} - w_{ij}}.
}

By default, block labels are assigned deterministically as
\code{rep(seq_len(K), length.out = n_players)} to mirror your example, but you can
pass a custom label vector via \code{x}.
}
